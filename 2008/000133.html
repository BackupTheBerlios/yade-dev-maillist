<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [yade-dev] Fwd: r1285 - in trunk/pkg/dem: .	DataClass/InteractionPhysics DataClass/PhysicalParameters	Engine/EngineUnit Engine/StandAloneEngine PreProcessor	RenderingEngine RenderingEngine/GLDrawSimpleViscoelasticInteraction
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/yade-dev/2008/index.html" >
   <LINK REL="made" HREF="mailto:yade-dev%40lists.berlios.de?Subject=Re%3A%20%5Byade-dev%5D%20Fwd%3A%20r1285%20-%20in%20trunk/pkg/dem%3A%20.%0A%09DataClass/InteractionPhysics%20DataClass/PhysicalParameters%0A%09Engine/EngineUnit%20Engine/StandAloneEngine%20PreProcessor%0A%09RenderingEngine%20RenderingEngine/GLDrawSimpleViscoelasticInteraction&In-Reply-To=%3C200803261238.26791.dorofeenko%40icp.ac.ru%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000135.html">
   <LINK REL="Next"  HREF="000136.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[yade-dev] Fwd: r1285 - in trunk/pkg/dem: .	DataClass/InteractionPhysics DataClass/PhysicalParameters	Engine/EngineUnit Engine/StandAloneEngine PreProcessor	RenderingEngine RenderingEngine/GLDrawSimpleViscoelasticInteraction</H1>
    <B>sega</B> 
    <A HREF="mailto:yade-dev%40lists.berlios.de?Subject=Re%3A%20%5Byade-dev%5D%20Fwd%3A%20r1285%20-%20in%20trunk/pkg/dem%3A%20.%0A%09DataClass/InteractionPhysics%20DataClass/PhysicalParameters%0A%09Engine/EngineUnit%20Engine/StandAloneEngine%20PreProcessor%0A%09RenderingEngine%20RenderingEngine/GLDrawSimpleViscoelasticInteraction&In-Reply-To=%3C200803261238.26791.dorofeenko%40icp.ac.ru%3E"
       TITLE="[yade-dev] Fwd: r1285 - in trunk/pkg/dem: .	DataClass/InteractionPhysics DataClass/PhysicalParameters	Engine/EngineUnit Engine/StandAloneEngine PreProcessor	RenderingEngine RenderingEngine/GLDrawSimpleViscoelasticInteraction">dorofeenko at icp.ac.ru
       </A><BR>
    <I>Wed Mar 26 10:38:26 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000135.html">[yade-dev] svn-1284 compile error
</A></li>
        <LI>Next message: <A HREF="000136.html">[yade-dev] using cerr in TriaxialTest
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#133">[ date ]</a>
              <a href="thread.html#133">[ thread ]</a>
              <a href="subject.html#133">[ subject ]</a>
              <a href="author.html#133">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: sega
Date: 2008-03-25 20:13:54 +0100 (Tue, 25 Mar 2008)
New Revision: 1285

Added:
   trunk/pkg/dem/DataClass/InteractionPhysics/SimpleViscoelasticInteraction.cpp
   trunk/pkg/dem/DataClass/InteractionPhysics/SimpleViscoelasticInteraction.hpp
   trunk/pkg/dem/DataClass/PhysicalParameters/SimpleViscoelasticBodyParameters.cpp
   trunk/pkg/dem/DataClass/PhysicalParameters/SimpleViscoelasticBodyParameters.hpp
   trunk/pkg/dem/Engine/EngineUnit/SimpleViscoelasticRelationships.cpp
   trunk/pkg/dem/Engine/EngineUnit/SimpleViscoelasticRelationships.hpp
   trunk/pkg/dem/Engine/StandAloneEngine/RigidBodyRecorder.cpp
   trunk/pkg/dem/Engine/StandAloneEngine/RigidBodyRecorder.hpp
   trunk/pkg/dem/Engine/StandAloneEngine/SimpleViscoelasticContactLaw.cpp
   trunk/pkg/dem/Engine/StandAloneEngine/SimpleViscoelasticContactLaw.hpp
   trunk/pkg/dem/Engine/StandAloneEngine/SimpleViscoelasticSpheresInteractionRecorder.cpp
   trunk/pkg/dem/Engine/StandAloneEngine/SimpleViscoelasticSpheresInteractionRecorder.hpp
   trunk/pkg/dem/PreProcessor/TestSimpleViscoelastic.cpp
   trunk/pkg/dem/PreProcessor/TestSimpleViscoelastic.hpp
   trunk/pkg/dem/RenderingEngine/GLDrawSimpleViscoelasticInteraction/
   trunk/pkg/dem/RenderingEngine/GLDrawSimpleViscoelasticInteraction/GLDrawSimpleViscoelasticInteraction.cpp
   trunk/pkg/dem/RenderingEngine/GLDrawSimpleViscoelasticInteraction/GLDrawSimpleViscoelasticInteraction.hpp
Modified:
   trunk/pkg/dem/SConscript
Log:
Add linear viscoelastic contact model


Added: trunk/pkg/dem/DataClass/InteractionPhysics/SimpleViscoelasticInteraction.cpp
===================================================================
--- trunk/pkg/dem/DataClass/InteractionPhysics/SimpleViscoelasticInteraction.cpp	2008-03-25 09:54:02 UTC (rev 1284)
+++ trunk/pkg/dem/DataClass/InteractionPhysics/SimpleViscoelasticInteraction.cpp	2008-03-25 19:13:54 UTC (rev 1285)
@@ -0,0 +1,31 @@
+/*************************************************************************
+*  Copyright (C) 2008 by Dorofeenko Sergei                               *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">sega at users.berlios.de</A>						 *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#include &quot;SimpleViscoelasticInteraction.hpp&quot;
+
+
+SimpleViscoelasticInteraction::SimpleViscoelasticInteraction()
+{
+	createIndex();
+}
+
+SimpleViscoelasticInteraction::~SimpleViscoelasticInteraction()
+{
+}
+
+void SimpleViscoelasticInteraction::registerAttributes()
+{
+	REGISTER_ATTRIBUTE(kn);
+	REGISTER_ATTRIBUTE(ks);
+	REGISTER_ATTRIBUTE(cn);
+	REGISTER_ATTRIBUTE(cs);
+	REGISTER_ATTRIBUTE(prevNormal);
+	REGISTER_ATTRIBUTE(normalForce);
+	REGISTER_ATTRIBUTE(shearForce);
+}
+YADE_PLUGIN();

Added: trunk/pkg/dem/DataClass/InteractionPhysics/SimpleViscoelasticInteraction.hpp
===================================================================
--- trunk/pkg/dem/DataClass/InteractionPhysics/SimpleViscoelasticInteraction.hpp	2008-03-25 09:54:02 UTC (rev 1284)
+++ trunk/pkg/dem/DataClass/InteractionPhysics/SimpleViscoelasticInteraction.hpp	2008-03-25 19:13:54 UTC (rev 1285)
@@ -0,0 +1,50 @@
+/*************************************************************************
+*  Copyright (C) 2008 by Sergei Dorofeenko                               *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">sega at users.berlios.de</A>						 *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#ifndef SIMPLEVISCOELASTICINTERACTION_HPP 
+#define SIMPLEVISCOELASTICINTERACTION_HPP
+
+#include&lt;yade/core/InteractionPhysics.hpp&gt;
+
+class SimpleViscoelasticInteraction : public InteractionPhysics
+{
+	public :
+	    
+	    /// Normal interaction elastic constants.
+	    Real kn;
+	    /// Normal interaction viscous constants.
+	    Real cn;
+	    /// Shear interaction elastic constants.
+	    Real ks;
+	    /// Shear interaction viscous constants.
+	    Real cs;
+	    /// Coulomb friction
+	    Real mu;
+	    /// Unit normal of the contact plane
+	    Vector3r prevNormal;
+	    /// Normal force
+	    Vector3r normalForce;
+	    /// Incremental shear force
+	    Vector3r shearForce;
+	
+		SimpleViscoelasticInteraction();
+		virtual ~SimpleViscoelasticInteraction();
+	protected :
+		virtual void registerAttributes();
+
+	REGISTER_CLASS_NAME(SimpleViscoelasticInteraction);
+	REGISTER_BASE_CLASS_NAME(InteractionPhysics);
+
+	REGISTER_CLASS_INDEX(SimpleViscoelasticInteraction,InteractionPhysics);
+
+};
+
+REGISTER_SERIALIZABLE(SimpleViscoelasticInteraction,false);
+
+#endif // SIMPLEVISCOELASTICINTERACTION_HPP
+

Added: trunk/pkg/dem/DataClass/PhysicalParameters/SimpleViscoelasticBodyParameters.cpp
===================================================================
--- trunk/pkg/dem/DataClass/PhysicalParameters/SimpleViscoelasticBodyParameters.cpp	2008-03-25 09:54:02 UTC (rev 1284)
+++ trunk/pkg/dem/DataClass/PhysicalParameters/SimpleViscoelasticBodyParameters.cpp	2008-03-25 19:13:54 UTC (rev 1285)
@@ -0,0 +1,41 @@
+/*************************************************************************
+*  Copyright (C) 2008 by Sergei Dorofeenko				 *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">sega at users.berlios.de</A>						 *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#include &quot;SimpleViscoelasticBodyParameters.hpp&quot;
+
+SimpleViscoelasticBodyParameters::SimpleViscoelasticBodyParameters() : RigidBodyParameters()
+{
+	createIndex();
+}
+
+SimpleViscoelasticBodyParameters::~SimpleViscoelasticBodyParameters()
+{
+}
+
+void SimpleViscoelasticBodyParameters::registerAttributes()
+{
+	RigidBodyParameters::registerAttributes();
+	REGISTER_ATTRIBUTE(kn);
+	REGISTER_ATTRIBUTE(ks);
+	REGISTER_ATTRIBUTE(cn);
+	REGISTER_ATTRIBUTE(cs);
+	REGISTER_ATTRIBUTE(mu);
+}
+
+void SimpleViscoelasticBodyParameters::setViscoelastic(Real m, Real tc, Real en, Real es)
+{
+    kn = m/tc/tc * ( Mathr::PI*Mathr::PI + Mathr::Pow(Mathr::Log(en),2) );
+    cn = -2.0*m/tc * Mathr::Log(en);
+    ks = 2.0/7.0 * m/tc/tc * ( Mathr::PI*Mathr::PI + Mathr::Pow(Mathr::Log(es),2) );
+    cs = -2.0/7.0 * m/tc * Mathr::Log(es);
+
+    if (Math&lt;Real&gt;::FAbs(cn) &lt;= Math&lt;Real&gt;::ZERO_TOLERANCE ) cn=0;
+    if (Math&lt;Real&gt;::FAbs(cs) &lt;= Math&lt;Real&gt;::ZERO_TOLERANCE ) cs=0;
+}
+YADE_PLUGIN();
+

Added: trunk/pkg/dem/DataClass/PhysicalParameters/SimpleViscoelasticBodyParameters.hpp
===================================================================
--- trunk/pkg/dem/DataClass/PhysicalParameters/SimpleViscoelasticBodyParameters.hpp	2008-03-25 09:54:02 UTC (rev 1284)
+++ trunk/pkg/dem/DataClass/PhysicalParameters/SimpleViscoelasticBodyParameters.hpp	2008-03-25 19:13:54 UTC (rev 1285)
@@ -0,0 +1,48 @@
+/*************************************************************************
+*  Copyright (C) 2008 by Sergei Dorofeenko				 *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">sega at users.berlios.de</A>						 *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#ifndef SIMPLEVISCOELASTICBODYPARAMETERS_HPP
+#define SIMPLEVISCOELASTICBODYPARAMETERS_HPP
+
+#include &lt;yade/pkg-common/RigidBodyParameters.hpp&gt;
+
+class SimpleViscoelasticBodyParameters : public RigidBodyParameters {	
+	public :
+
+	    /// Normal elastic constants of the body
+	    Real kn; 
+	    /// Normal viscous constants of the body
+	    Real cn; 
+	    /// Shear elastic constants of the body
+	    Real ks; 
+	    /// Shear viscous constants of the body
+	    Real cs; 
+	    /// Coulomb friction
+	    Real mu; 
+	
+		SimpleViscoelasticBodyParameters();
+		virtual ~SimpleViscoelasticBodyParameters();
+
+	    /// Set viscoelastic parameters kn,cn,ks,cs of the sphere from its
+	    /// mass m, collision time tc and restitution coefficients en,es.
+	    void setViscoelastic(Real m, Real tc, Real en, Real es);
+
+	protected :
+		/// Serialization
+		void registerAttributes();
+	REGISTER_CLASS_NAME(SimpleViscoelasticBodyParameters);
+	REGISTER_BASE_CLASS_NAME(RigidBodyParameters);
+	
+/// Indexable	
+	REGISTER_CLASS_INDEX(SimpleViscoelasticBodyParameters,RigidBodyParameters);
+};
+
+REGISTER_SERIALIZABLE(SimpleViscoelasticBodyParameters,false);
+
+#endif // SIMPLEVISCOELASTICBODYPARAMETERS_HPP
+

Added: trunk/pkg/dem/Engine/EngineUnit/SimpleViscoelasticRelationships.cpp
===================================================================
--- trunk/pkg/dem/Engine/EngineUnit/SimpleViscoelasticRelationships.cpp	2008-03-25 09:54:02 UTC (rev 1284)
+++ trunk/pkg/dem/Engine/EngineUnit/SimpleViscoelasticRelationships.cpp	2008-03-25 19:13:54 UTC (rev 1285)
@@ -0,0 +1,54 @@
+/*************************************************************************
+*  Copyright (C) 2008 by Dorofeenko Sergei				 *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">sega at users.berlios.de</A>						 *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#include&quot;SimpleViscoelasticRelationships.hpp&quot;
+#include&lt;yade/pkg-dem/SimpleViscoelasticBodyParameters.hpp&gt;
+#include&lt;yade/pkg-dem/SimpleViscoelasticInteraction.hpp&gt;
+#include&lt;yade/pkg-dem/SpheresContactGeometry.hpp&gt;
+#include&lt;yade/core/Omega.hpp&gt;
+#include&lt;yade/core/MetaBody.hpp&gt;
+
+
+SimpleViscoelasticRelationships::SimpleViscoelasticRelationships()
+{
+}
+
+
+void SimpleViscoelasticRelationships::registerAttributes()
+{
+}
+
+
+void SimpleViscoelasticRelationships::go(	  const shared_ptr&lt;PhysicalParameters&gt;&amp; b1 // SimpleViscoelasticBodyParameters
+					, const shared_ptr&lt;PhysicalParameters&gt;&amp; b2 // SimpleViscoelasticBodyParameters
+					, const shared_ptr&lt;Interaction&gt;&amp; interaction)
+{
+    if( !interaction-&gt;isNew ) return;
+
+    SimpleViscoelasticBodyParameters* sdec1 = static_cast&lt;SimpleViscoelasticBodyParameters*&gt;(b1.get());
+    SimpleViscoelasticBodyParameters* sdec2 = static_cast&lt;SimpleViscoelasticBodyParameters*&gt;(b2.get());
+    
+    interaction-&gt;interactionPhysics = shared_ptr&lt;SimpleViscoelasticInteraction&gt;(new SimpleViscoelasticInteraction());
+    SimpleViscoelasticInteraction* contactPhysics = YADE_CAST&lt;SimpleViscoelasticInteraction*&gt;(interaction-&gt;interactionPhysics.get());
+
+    contactPhysics-&gt;kn = sdec1-&gt;kn * sdec2-&gt;kn / (sdec1-&gt;kn + sdec2-&gt;kn);
+    contactPhysics-&gt;ks = sdec1-&gt;ks * sdec2-&gt;ks / (sdec1-&gt;ks + sdec2-&gt;ks);
+    
+    contactPhysics-&gt;cn = ( (sdec1-&gt;cn==0) ? 0 : 1/sdec1-&gt;cn ) + ( (sdec2-&gt;cn==0) ? 0 : 1/sdec2-&gt;cn );
+    contactPhysics-&gt;cs = ( (sdec1-&gt;cs==0) ? 0 : 1/sdec1-&gt;cs ) + ( (sdec2-&gt;cs==0) ? 0 : 1/sdec2-&gt;cs );
+    if (contactPhysics-&gt;cn) contactPhysics-&gt;cn = 1/contactPhysics-&gt;cn;
+    if (contactPhysics-&gt;cs) contactPhysics-&gt;cs = 1/contactPhysics-&gt;cs;
+   
+    contactPhysics-&gt;mu = std::min(sdec1-&gt;mu, sdec2-&gt;mu); // FIXME: May be (mu1+mu2)/2???
+
+    contactPhysics-&gt;shearForce = Vector3r(0,0,0);
+    contactPhysics-&gt;prevNormal = Vector3r(0,0,0);
+
+}
+
+YADE_PLUGIN();

Added: trunk/pkg/dem/Engine/EngineUnit/SimpleViscoelasticRelationships.hpp
===================================================================
--- trunk/pkg/dem/Engine/EngineUnit/SimpleViscoelasticRelationships.hpp	2008-03-25 09:54:02 UTC (rev 1284)
+++ trunk/pkg/dem/Engine/EngineUnit/SimpleViscoelasticRelationships.hpp	2008-03-25 19:13:54 UTC (rev 1285)
@@ -0,0 +1,38 @@
+/*************************************************************************
+*  Copyright (C) 2008 by Sergei Dorofeenko				 *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">sega at users.berlios.de</A>						 *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#ifndef SIMPLEVISCOELASTICRELATIIONSHIPS_HPP 
+#define SIMPLEVISCOELASTICRELATIIONSHIPS_HPP
+
+#include&lt;yade/pkg-common/InteractionPhysicsEngineUnit.hpp&gt;
+
+/// From viscoelastic parameters of the pair bodys provides
+/// viscoelastic parameters of their interaction by the rule of consecutively connection.
+class SimpleViscoelasticRelationships : public InteractionPhysicsEngineUnit
+{
+	public :
+
+		SimpleViscoelasticRelationships();
+
+		virtual void go(	const shared_ptr&lt;PhysicalParameters&gt;&amp; b1,
+					const shared_ptr&lt;PhysicalParameters&gt;&amp; b2,
+					const shared_ptr&lt;Interaction&gt;&amp; interaction);
+
+	protected :
+		virtual void registerAttributes();
+
+	FUNCTOR2D(SimpleViscoelasticBodyParameters,SimpleViscoelasticBodyParameters);
+	REGISTER_CLASS_NAME(SimpleViscoelasticRelationships);
+	REGISTER_BASE_CLASS_NAME(InteractionPhysicsEngineUnit);
+
+};
+
+REGISTER_SERIALIZABLE(SimpleViscoelasticRelationships,false);
+
+#endif // SIMPLEVISCOELASTICRELATIIONSHIPS_HPP
+

Added: trunk/pkg/dem/Engine/StandAloneEngine/RigidBodyRecorder.cpp
===================================================================
--- trunk/pkg/dem/Engine/StandAloneEngine/RigidBodyRecorder.cpp	2008-03-25 09:54:02 UTC (rev 1284)
+++ trunk/pkg/dem/Engine/StandAloneEngine/RigidBodyRecorder.cpp	2008-03-25 19:13:54 UTC (rev 1285)
@@ -0,0 +1,107 @@
+/*************************************************************************
+*  Copyright (C) 2008 by Sergei Dorofeenko                               *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">sega at users.berlios.de</A>                                                 *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+#include &quot;RigidBodyRecorder.hpp&quot;
+#include &lt;yade/core/Omega.hpp&gt;
+#include &lt;yade/core/MetaBody.hpp&gt;
+#include &lt;boost/lexical_cast.hpp&gt;
+
+RigidBodyRecorder::RigidBodyRecorder(): DataRecorder(), rigidBodyParameters(new RigidBodyParameters)
+{
+	outputBase = &quot;rigidbody&quot;;
+	interval=50;
+}
+
+
+RigidBodyRecorder::~RigidBodyRecorder ()
+{
+
+}
+
+
+void RigidBodyRecorder::postProcessAttributes(bool deserializing)
+{
+	if(deserializing)
+	{
+        //
+	}
+}
+
+
+void RigidBodyRecorder::registerAttributes()
+{
+	DataRecorder::registerAttributes();
+	REGISTER_ATTRIBUTE(outputBase);
+	REGISTER_ATTRIBUTE(interval);
+}
+
+bool RigidBodyRecorder::isActivated()
+{
+   return ((Omega::instance().getCurrentIteration() % interval == 0));
+}
+
+void RigidBodyRecorder::action(Body * body)
+{
+    MetaBody * ncb = YADE_CAST&lt;MetaBody*&gt;(body);
+    shared_ptr&lt;BodyContainer&gt;&amp; bodies = ncb-&gt;bodies;
+
+    BodyContainer::iterator bi	    = bodies-&gt;begin();
+    BodyContainer::iterator biEnd   = bodies-&gt;end();
+    for(;bi!=biEnd;++bi)
+    {
+	const shared_ptr&lt;Body&gt;&amp; b = *bi;
+	int bId = b-&gt;getId();
+
+	const RigidBodyParameters* p = YADE_CAST&lt;RigidBodyParameters*&gt;(b-&gt;physicalParameters.get());
+	std::string outputFile = outputBase+lexical_cast&lt;string&gt;(bId) + &quot;.dat&quot;;
+
+	std::ofstream ofs;
+	
+	if (body_ids.insert(bId).second)
+	{
+	    ofs.open(outputFile.c_str());
+	    if (!ofs)
+	    {
+		cerr &lt;&lt; &quot;ERROR: Can't open file: &quot; &lt;&lt; outputFile &lt;&lt; std::endl;
+		return;
+	    }
+	    ofs &lt;&lt; &quot;#(t - time; c - position; v - velocity; a - acceleration; w - angular velocity; b - angular acceleration)\n&quot; 
+		&lt;&lt; &quot;#t(1)\tcx(2)\tcy(3)\tcz(4)\tvx(5)\tvy(6)\tvz(7)\tax(8)\tay(9)\taz(10)\twx(11)\twy(12)\twz(13)\tbx(14)\tby(15)\tbz(16)&quot; 
+		&lt;&lt; std::endl;
+	}
+	else
+	{
+	    ofs.open(outputFile.c_str(),ios::app);
+	    if (!ofs)
+	    {
+		cerr &lt;&lt; &quot;ERROR: Can't open file: &quot; &lt;&lt; outputFile &lt;&lt; std::endl;
+		return;
+	    }
+	}
+	
+	ofs &lt;&lt; lexical_cast&lt;string&gt;( Omega::instance().getCurrentIteration() ) &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;se3.position[0] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;se3.position[1] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;se3.position[2] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;velocity[0] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;velocity[1] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;velocity[2] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;acceleration[0] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;acceleration[1] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;acceleration[2] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;angularVelocity[0] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;angularVelocity[1] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;angularVelocity[2] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;angularAcceleration[0] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;angularAcceleration[1] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;angularAcceleration[2] &lt;&lt; '\t'
+	    &lt;&lt; endl;
+	ofs.close();
+    }
+}
+
+YADE_PLUGIN();

Added: trunk/pkg/dem/Engine/StandAloneEngine/RigidBodyRecorder.hpp
===================================================================
--- trunk/pkg/dem/Engine/StandAloneEngine/RigidBodyRecorder.hpp	2008-03-25 09:54:02 UTC (rev 1284)
+++ trunk/pkg/dem/Engine/StandAloneEngine/RigidBodyRecorder.hpp	2008-03-25 19:13:54 UTC (rev 1285)
@@ -0,0 +1,42 @@
+/*************************************************************************
+*  Copyright (C) 2008 by Sergei Dorofeenko                               *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">sega at users.berlios.de</A>                                                 *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+#ifndef RIGIDBODYRECORDER_HPP
+#define RIGIDBODYRECORDER_HPP
+
+#include &lt;yade/core/DataRecorder.hpp&gt;
+#include &lt;yade/pkg-common/RigidBodyParameters.hpp&gt;
+#include &lt;set&gt;
+
+/// Saves RigidBodyParameters of the body Id in the file outputBaseId,
+class RigidBodyRecorder : public DataRecorder {
+    private:
+	shared_ptr&lt;RigidBodyParameters&gt; rigidBodyParameters;
+	set&lt;int&gt; body_ids;
+
+
+public :
+    string outputBase; 
+    int interval;
+
+
+    RigidBodyRecorder ();
+    ~RigidBodyRecorder ();
+
+    virtual void action(Body* body);
+      bool isActivated();
+
+protected :
+    virtual void postProcessAttributes(bool deserializing);
+    void registerAttributes();
+    REGISTER_CLASS_NAME(RigidBodyRecorder);
+    REGISTER_BASE_CLASS_NAME(DataRecorder);
+};
+REGISTER_SERIALIZABLE(RigidBodyRecorder ,false);
+
+#endif // RIGIDBODYRECORDER_HPP
+

Added: trunk/pkg/dem/Engine/StandAloneEngine/SimpleViscoelasticContactLaw.cpp
===================================================================
--- trunk/pkg/dem/Engine/StandAloneEngine/SimpleViscoelasticContactLaw.cpp	2008-03-25 09:54:02 UTC (rev 1284)
+++ trunk/pkg/dem/Engine/StandAloneEngine/SimpleViscoelasticContactLaw.cpp	2008-03-25 19:13:54 UTC (rev 1285)
@@ -0,0 +1,138 @@
+/*************************************************************************
+*  Copyright (C) 2004 by Olivier Galizzi                                 *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">olivier.galizzi at imag.fr</A>                                               *
+*									 *
+*  Copyright (C) 2008 by Sergei Dorofeenko                               *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">sega at users.berlios.de</A>                                                 *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#include&quot;SimpleViscoelasticContactLaw.hpp&quot;
+#include&lt;yade/pkg-dem/SimpleViscoelasticBodyParameters.hpp&gt;
+#include&lt;yade/pkg-dem/SimpleViscoelasticInteraction.hpp&gt;
+#include&lt;yade/pkg-dem/SpheresContactGeometry.hpp&gt;
+#include&lt;yade/core/Omega.hpp&gt;
+#include&lt;yade/core/MetaBody.hpp&gt;
+#include&lt;yade/pkg-common/Force.hpp&gt;
+#include&lt;yade/pkg-common/Momentum.hpp&gt;
+#include&lt;yade/core/PhysicalAction.hpp&gt;
+
+
+SimpleViscoelasticContactLaw::SimpleViscoelasticContactLaw() : InteractionSolver() , actionForce(new Force) , actionMomentum(new Momentum)
+{
+//	sdecGroupMask=1;
+	momentRotationLaw = true;
+	actionForceIndex = actionForce-&gt;getClassIndex();
+	actionMomentumIndex = actionMomentum-&gt;getClassIndex();
+}
+
+
+void SimpleViscoelasticContactLaw::registerAttributes()
+{
+	InteractionSolver::registerAttributes();
+//	REGISTER_ATTRIBUTE(sdecGroupMask);
+	REGISTER_ATTRIBUTE(momentRotationLaw);
+}
+
+
+void SimpleViscoelasticContactLaw::action(Body* body)
+{
+	MetaBody * ncb = YADE_CAST&lt;MetaBody*&gt;(body);
+	shared_ptr&lt;BodyContainer&gt;&amp; bodies = ncb-&gt;bodies;
+
+	Real dt = Omega::instance().getTimeStep();
+
+/// Non Permanents Links	///
+
+	InteractionContainer::iterator ii    = ncb-&gt;transientInteractions-&gt;begin();
+	InteractionContainer::iterator iiEnd = ncb-&gt;transientInteractions-&gt;end();
+	for(  ; ii!=iiEnd ; ++ii )
+	{
+		if ((*ii)-&gt;isReal)
+		{
+			const shared_ptr&lt;Interaction&gt;&amp; contact = *ii;
+			int id1 = contact-&gt;getId1();
+			int id2 = contact-&gt;getId2();
+			
+//			if( !( (*bodies)[id1]-&gt;getGroupMask() &amp; (*bodies)[id2]-&gt;getGroupMask() &amp; sdecGroupMask) ) continue;
+
+			SpheresContactGeometry*    currentContactGeometry= YADE_CAST&lt;SpheresContactGeometry*&gt;(contact-&gt;interactionGeometry.get());
+			SimpleViscoelasticInteraction*  currentContactPhysics = YADE_CAST&lt;SimpleViscoelasticInteraction*&gt; (contact-&gt;interactionPhysics.get());
+			if((!currentContactGeometry)||(!currentContactPhysics)) continue;
+	
+			SimpleViscoelasticBodyParameters* de1	= YADE_CAST&lt;SimpleViscoelasticBodyParameters*&gt;((*bodies)[id1]-&gt;physicalParameters.get());
+			SimpleViscoelasticBodyParameters* de2	= YADE_CAST&lt;SimpleViscoelasticBodyParameters*&gt;((*bodies)[id2]-&gt;physicalParameters.get());
+			
+			Vector3r&amp; normal			= currentContactGeometry-&gt;normal;
+			Vector3r x				= currentContactGeometry-&gt;contactPoint;
+			Vector3r c1x				= (x - de1-&gt;se3.position);
+			Vector3r c2x				= (x - de2-&gt;se3.position);
+			Vector3r relativeVelocity		= (de2-&gt;velocity+de2-&gt;angularVelocity.Cross(c2x)) - (de1-&gt;velocity+de1-&gt;angularVelocity.Cross(c1x));
+			Real     normalVelocity			= normal.Dot(relativeVelocity);
+			Vector3r shearVelocity			= relativeVelocity-normalVelocity*normal;
+
+			Real kn=currentContactPhysics-&gt;kn;
+			Real cn=currentContactPhysics-&gt;cn;
+			Real un=currentContactGeometry-&gt;penetrationDepth;
+			currentContactPhysics-&gt;normalForce = ( kn * un - cn * normalVelocity ) * normal;
+	
+			Vector3r&amp; shearForce 			= currentContactPhysics-&gt;shearForce;
+
+			Vector3r axis;
+			Real angle;
+	
+	/// Here is the code with approximated rotations 	 ///
+			
+			axis = currentContactPhysics-&gt;prevNormal.Cross(normal);
+			shearForce -= shearForce.Cross(axis);
+			angle = dt*0.5*normal.Dot(de1-&gt;angularVelocity+de2-&gt;angularVelocity);
+			axis = angle*normal;
+			shearForce -= shearForce.Cross(axis);
+		
+	/// Here is the code with exact rotations 		 ///
+	
+	// 		Quaternionr q;
+	//
+	// 		axis					= currentContactPhysics-&gt;prevNormal.cross(currentContactGeometry-&gt;normal);
+	// 		angle					= acos(currentContactGeometry-&gt;normal.dot(currentContactPhysics-&gt;prevNormal));
+	// 		q.fromAngleAxis(angle,axis);
+	//
+	// 		currentContactPhysics-&gt;shearForce	= currentContactPhysics-&gt;shearForce*q;
+	//
+	// 		angle					= dt*0.5*currentContactGeometry-&gt;normal.dot(de1-&gt;angularVelocity+de2-&gt;angularVelocity);
+	// 		axis					= currentContactGeometry-&gt;normal;
+	// 		q.fromAngleAxis(angle,axis);
+	// 		currentContactPhysics-&gt;shearForce	= q*currentContactPhysics-&gt;shearForce;
+	
+	
+			Real ks = currentContactPhysics-&gt;ks;
+			Real cs = currentContactPhysics-&gt;cs;
+			shearForce 			       -= (ks*dt+cs)*shearVelocity;
+	
+	// PFC3d SlipModel, is using friction angle. CoulombCriterion
+			Real maxFs = currentContactPhysics-&gt;normalForce.SquaredLength() * std::pow(currentContactPhysics-&gt;mu,2);
+			if( shearForce.SquaredLength() &gt; maxFs )
+			{
+				maxFs = Mathr::Sqrt(maxFs) / shearForce.Length();
+				shearForce *= maxFs;
+			}
+	////////// PFC3d SlipModel
+	
+			Vector3r f				= currentContactPhysics-&gt;normalForce + shearForce;
+			
+	// it will be some macro(	body-&gt;physicalActions,	ActionType , bodyId )
+			static_cast&lt;Force*&gt;   ( ncb-&gt;physicalActions-&gt;find( id1 , actionForceIndex).get() )-&gt;force    -= f;
+			static_cast&lt;Force*&gt;   ( ncb-&gt;physicalActions-&gt;find( id2 , actionForceIndex ).get() )-&gt;force   += f;
+			
+			static_cast&lt;Momentum*&gt;( ncb-&gt;physicalActions-&gt;find( id1 , actionMomentumIndex ).get() )-&gt;momentum -= c1x.Cross(f);
+			static_cast&lt;Momentum*&gt;( ncb-&gt;physicalActions-&gt;find( id2 , actionMomentumIndex ).get() )-&gt;momentum += c2x.Cross(f);
+			
+			currentContactPhysics-&gt;prevNormal = normal;
+		}
+	}
+}
+
+
+YADE_PLUGIN();

Added: trunk/pkg/dem/Engine/StandAloneEngine/SimpleViscoelasticContactLaw.hpp
===================================================================
--- trunk/pkg/dem/Engine/StandAloneEngine/SimpleViscoelasticContactLaw.hpp	2008-03-25 09:54:02 UTC (rev 1284)
+++ trunk/pkg/dem/Engine/StandAloneEngine/SimpleViscoelasticContactLaw.hpp	2008-03-25 19:13:54 UTC (rev 1285)
@@ -0,0 +1,45 @@
+/*************************************************************************
+*  Copyright (C) 2004 by Olivier Galizzi                                 *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">olivier.galizzi at imag.fr</A>                                               *
+*									 *
+*  Copyright (C) 2008 by Sergei Dorofeenko                               *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">sega at users.berlios.de</A>                                                 *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#ifndef SIMPLEVISCOELASTIC_CONTACT_LAW_HPP
+#define SIMPLEVISCOELASTIC_CONTACT_LAW_HPP
+
+#include&lt;yade/core/InteractionSolver.hpp&gt;
+
+class PhysicalAction;
+
+/// This class provides linear viscoelastic contact model
+class SimpleViscoelasticContactLaw : public InteractionSolver
+{
+/// Attributes
+	private :
+		shared_ptr&lt;PhysicalAction&gt; actionForce;
+		shared_ptr&lt;PhysicalAction&gt; actionMomentum;
+		int actionForceIndex;
+		int actionMomentumIndex;
+		
+	public :
+//		int sdecGroupMask;
+		bool momentRotationLaw;
+	
+		SimpleViscoelasticContactLaw();
+		void action(Body* body);
+
+	protected :
+		void registerAttributes();
+	REGISTER_CLASS_NAME(SimpleViscoelasticContactLaw);
+	REGISTER_BASE_CLASS_NAME(InteractionSolver);
+};
+
+REGISTER_SERIALIZABLE(SimpleViscoelasticContactLaw,false);
+
+#endif // SIMPLEVISCOELASTIC_CONTACT_LAW_HPP
+

Added: trunk/pkg/dem/Engine/StandAloneEngine/SimpleViscoelasticSpheresInteractionRecorder.cpp
===================================================================
--- trunk/pkg/dem/Engine/StandAloneEngine/SimpleViscoelasticSpheresInteractionRecorder.cpp	2008-03-25 09:54:02 UTC (rev 1284)
+++ trunk/pkg/dem/Engine/StandAloneEngine/SimpleViscoelasticSpheresInteractionRecorder.cpp	2008-03-25 19:13:54 UTC (rev 1285)
@@ -0,0 +1,104 @@
+/*************************************************************************
+*  Copyright (C) 2006 by Sergei Dorofeenko				 *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">sega at users.berlios.de</A>                                                 *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+#include &quot;SimpleViscoelasticSpheresInteractionRecorder.hpp&quot;
+#include &lt;yade/core/Omega.hpp&gt;
+#include &lt;yade/core/MetaBody.hpp&gt;
+#include &lt;boost/lexical_cast.hpp&gt;
+
+SimpleViscoelasticSpheresInteractionRecorder::SimpleViscoelasticSpheresInteractionRecorder (): DataRecorder(), interactionSphere(new SpheresContactGeometry), viscoelasticInteraction(new SimpleViscoelasticInteraction)
+{
+	outputBase = &quot;contacts&quot;;
+	interval=50;
+}
+
+
+SimpleViscoelasticSpheresInteractionRecorder::~SimpleViscoelasticSpheresInteractionRecorder ()
+{
+
+}
+
+
+void SimpleViscoelasticSpheresInteractionRecorder::postProcessAttributes(bool deserializing)
+{
+	if(deserializing)
+	{
+        //
+	}
+}
+
+
+void SimpleViscoelasticSpheresInteractionRecorder::registerAttributes()
+{
+	DataRecorder::registerAttributes();
+	REGISTER_ATTRIBUTE(outputBase);
+	REGISTER_ATTRIBUTE(interval);
+}
+
+bool SimpleViscoelasticSpheresInteractionRecorder::isActivated()
+{
+   return ((Omega::instance().getCurrentIteration() % interval == 0));
+}
+
+void SimpleViscoelasticSpheresInteractionRecorder::action(Body * body)
+{
+    MetaBody * ncb = YADE_CAST&lt;MetaBody*&gt;(body);
+    shared_ptr&lt;InteractionContainer&gt;&amp; interactions = ncb-&gt;transientInteractions;
+  
+    InteractionContainer::iterator ii    = interactions-&gt;begin();
+    InteractionContainer::iterator iiEnd = interactions-&gt;end();
+    for(  ; ii!=iiEnd ; ++ii )
+    {
+	const shared_ptr&lt;Interaction&gt;&amp; i = *ii;
+	if ( !i-&gt;isReal ) continue;
+	if ( i-&gt;interactionGeometry-&gt;getClassIndex() != interactionSphere-&gt;getClassIndex() ) continue;
+	if ( i-&gt;interactionPhysics-&gt;getClassIndex() != viscoelasticInteraction-&gt;getClassIndex() ) continue;
+
+	const SpheresContactGeometry* s = static_cast&lt;SpheresContactGeometry*&gt;(i-&gt;interactionGeometry.get());
+	const SimpleViscoelasticInteraction* p = static_cast&lt;SimpleViscoelasticInteraction*&gt;(i-&gt;interactionPhysics.get());
+
+	std::string outputFile = outputBase+lexical_cast&lt;string&gt;(i-&gt;getId1())+&quot;-&quot;+lexical_cast&lt;string&gt;(i-&gt;getId2())+&quot;.dat&quot;;
+	
+	std::ofstream ofs;
+
+	if (interaction_ids.insert(pair&lt;int,int&gt;(i-&gt;getId1(),i-&gt;getId2())).second)
+	{
+	    ofs.open(outputFile.c_str());
+	    if (!ofs)
+	    {
+		std::cerr &lt;&lt; &quot;ERROR: Can't open file: &quot; &lt;&lt; outputFile &lt;&lt; std::endl;
+		return;
+	    }
+	    ofs &lt;&lt; &quot;#(t - time; d - penetration depth; F - normal force; S - shear force)\n&quot;
+		&lt;&lt; &quot;#t(1)\td(2)\tFx(3)\tFy(4)\tFz(5)\tSx(6)\tSy(7)\tSz(8)&quot;
+		&lt;&lt; std::endl;
+	}
+	else
+	{
+	    ofs.open(outputFile.c_str(),std::ios::app);
+	    if (!ofs)
+	    {
+		std::cerr &lt;&lt; &quot;ERROR: Can't open file: &quot; &lt;&lt; outputFile &lt;&lt; std::endl;
+		return;
+	    }
+	}
+
+	ofs &lt;&lt; lexical_cast&lt;string&gt;( Omega::instance().getCurrentIteration() ) &lt;&lt; '\t'
+	    &lt;&lt; s-&gt;penetrationDepth &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;normalForce[0] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;normalForce[1] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;normalForce[2] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;shearForce[0] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;shearForce[1] &lt;&lt; '\t'
+	    &lt;&lt; p-&gt;shearForce[2] &lt;&lt; '\t'
+	    &lt;&lt; std::endl;
+	ofs.close();
+    }
+}
+
+YADE_PLUGIN();
+

Added: trunk/pkg/dem/Engine/StandAloneEngine/SimpleViscoelasticSpheresInteractionRecorder.hpp
===================================================================
--- trunk/pkg/dem/Engine/StandAloneEngine/SimpleViscoelasticSpheresInteractionRecorder.hpp	2008-03-25 09:54:02 UTC (rev 1284)
+++ trunk/pkg/dem/Engine/StandAloneEngine/SimpleViscoelasticSpheresInteractionRecorder.hpp	2008-03-25 19:13:54 UTC (rev 1285)
@@ -0,0 +1,45 @@
+/*************************************************************************
+*  Copyright (C) 2006 by Sergei Dorofeenko				 *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">sega at users.berlios.de</A>                                                 *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+#ifndef SIMPLEVISCOELASTICSPHERESINTERACTIONRECORDER_HPP
+#define SIMPLEVISCOELASTICSPHERESINTERACTIONRECORDER_HPP
+
+#include &lt;yade/core/DataRecorder.hpp&gt;
+#include &lt;yade/pkg-dem/SpheresContactGeometry.hpp&gt;
+#include &lt;yade/pkg-dem/SimpleViscoelasticInteraction.hpp&gt;
+#include &lt;set&gt;
+
+/// Save SpheresContactGeometry and SimpleViscoelasticInteraction of the
+/// interaction between the body Id1 and the body Id2 into the file
+/// outputBaseId1-Id2.
+class SimpleViscoelasticSpheresInteractionRecorder : public DataRecorder {
+private: 
+    shared_ptr&lt;SpheresContactGeometry&gt; interactionSphere;
+    shared_ptr&lt;SimpleViscoelasticInteraction&gt; viscoelasticInteraction;
+    set&lt;pair&lt;int,int&gt; &gt; interaction_ids;
+
+public :
+    /// Base name of output file.
+    string outputBase;
+    /// Saves interval
+    int interval;
+
+    SimpleViscoelasticSpheresInteractionRecorder();
+    ~SimpleViscoelasticSpheresInteractionRecorder();
+
+    virtual void action(Body* body);
+    bool isActivated();
+
+protected :
+    virtual void postProcessAttributes(bool deserializing);
+    void registerAttributes();
+    REGISTER_CLASS_NAME(SimpleViscoelasticSpheresInteractionRecorder);
+    REGISTER_BASE_CLASS_NAME(DataRecorder);
+};
+REGISTER_SERIALIZABLE(SimpleViscoelasticSpheresInteractionRecorder,false);
+
+#endif // SIMPLEVISCOELASTICSPHERESINTERACTIONRECORDER_HPP

Added: trunk/pkg/dem/PreProcessor/TestSimpleViscoelastic.cpp
===================================================================
--- trunk/pkg/dem/PreProcessor/TestSimpleViscoelastic.cpp	2008-03-25 09:54:02 UTC (rev 1284)
+++ trunk/pkg/dem/PreProcessor/TestSimpleViscoelastic.cpp	2008-03-25 19:13:54 UTC (rev 1285)
@@ -0,0 +1,290 @@
+/*************************************************************************
+*  Copyright (C) 2006 by Sergei Dorofeenko				 *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">sega at users.berlios.de</A>                                                 *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+#include &quot;TestSimpleViscoelastic.hpp&quot;
+#include &lt;yade/core/Body.hpp&gt;
+#include &lt;yade/core/MetaBody.hpp&gt;
+#include&lt;yade/core/Body.hpp&gt;
+#include&lt;yade/core/Interaction.hpp&gt;
+#include&lt;yade/core/MetaBody.hpp&gt;
+#include&lt;yade/pkg-common/AABB.hpp&gt;
+#include&lt;yade/pkg-common/BodyRedirectionVector.hpp&gt;
+#include&lt;yade/pkg-common/BoundingVolumeMetaEngine.hpp&gt;
+#include&lt;yade/pkg-common/InteractingSphere.hpp&gt;
+#include&lt;yade/pkg-common/InteractingBox.hpp&gt;
+#include&lt;yade/pkg-common/InteractionGeometryMetaEngine.hpp&gt;
+#include&lt;yade/pkg-common/InteractionPhysicsMetaEngine.hpp&gt;
+#include&lt;yade/pkg-common/InteractionVecSet.hpp&gt;
+#include&lt;yade/pkg-common/MetaInteractingGeometry.hpp&gt;
+#include&lt;yade/pkg-common/MetaInteractingGeometry2AABB.hpp&gt;
+#include&lt;yade/pkg-common/PersistentSAPCollider.hpp&gt;
+#include&lt;yade/pkg-common/PhysicalActionApplier.hpp&gt;
+#include&lt;yade/pkg-common/PhysicalActionContainerInitializer.hpp&gt;
+#include&lt;yade/pkg-common/PhysicalActionContainerReseter.hpp&gt;
+#include&lt;yade/pkg-common/PhysicalActionVectorVector.hpp&gt;
+#include&lt;yade/pkg-common/PhysicalParametersMetaEngine.hpp&gt;
+#include&lt;yade/pkg-common/Sphere.hpp&gt;
+#include&lt;yade/pkg-common/Box.hpp&gt;
+#include&lt;yade/pkg-dem/RigidBodyRecorder.hpp&gt;
+#include&lt;yade/pkg-dem/SimpleViscoelasticSpheresInteractionRecorder.hpp&gt;
+#include&lt;yade/pkg-dem/SimpleViscoelasticBodyParameters.hpp&gt;
+#include&lt;yade/pkg-dem/SimpleViscoelasticContactLaw.hpp&gt;
+#include&lt;yade/pkg-dem/SimpleViscoelasticRelationships.hpp&gt;
+#include&lt;yade/pkg-common/GravityEngine.hpp&gt;
+
+TestSimpleViscoelastic::TestSimpleViscoelastic() : FileGenerator()
+{
+    tc = 0.001;
+    en = 0.3;
+    es = 0.3;
+    mu = 0.1;
+    R  = 1;
+    density = 2600;
+    nbSpheres = 10;
+    h  = 1;
+    velocity = Vector3r(0,-1,0);
+    angular_vel = Vector3r(0,0,0);
+    rotationBlocked=false;
+    groundSize = Vector3r(10,1,10);
+    gravity = Vector3r(0,-9.81,0);
+    outputBase=&quot;test&quot;;
+    interval=50;
+}
+
+TestSimpleViscoelastic::~TestSimpleViscoelastic()
+{}
+
+void TestSimpleViscoelastic::postProcessAttributes(bool)
+{}
+
+void TestSimpleViscoelastic::registerAttributes()
+{
+    FileGenerator::registerAttributes();
+    REGISTER_ATTRIBUTE(tc);
+    REGISTER_ATTRIBUTE(en);
+    REGISTER_ATTRIBUTE(es);
+    REGISTER_ATTRIBUTE(mu);
+    REGISTER_ATTRIBUTE(R);
+    REGISTER_ATTRIBUTE(density);
+    REGISTER_ATTRIBUTE(nbSpheres);
+    REGISTER_ATTRIBUTE(h);
+    REGISTER_ATTRIBUTE(velocity);
+    REGISTER_ATTRIBUTE(angular_vel);
+    REGISTER_ATTRIBUTE(rotationBlocked);
+    REGISTER_ATTRIBUTE(gravity);
+    REGISTER_ATTRIBUTE(groundSize);
+    REGISTER_ATTRIBUTE(outputBase);
+    REGISTER_ATTRIBUTE(interval);
+}
+
+bool TestSimpleViscoelastic::generate()
+{
+    rootBody = shared_ptr&lt;MetaBody&gt;(new MetaBody);
+    createActors(rootBody);
+    positionRootBody(rootBody);
+    
+////////////////////////////////////
+///////// Container
+	
+    rootBody-&gt;persistentInteractions	= shared_ptr&lt;InteractionContainer&gt;(new InteractionVecSet);
+    rootBody-&gt;transientInteractions	= shared_ptr&lt;InteractionContainer&gt;(new InteractionVecSet);
+    rootBody-&gt;physicalActions		= shared_ptr&lt;PhysicalActionContainer&gt;(new PhysicalActionVectorVector);
+    rootBody-&gt;bodies			= shared_ptr&lt;BodyContainer&gt;(new BodyRedirectionVector);
+
+////////////////////////////////////
+///////// ground
+    
+    shared_ptr&lt;Body&gt; ground;
+    createBox(ground, Vector3r(0,0,0),groundSize);
+    rootBody-&gt;bodies-&gt;insert(ground);
+
+////////////////////////////////////
+///////// Spheres
+
+    float all = nbSpheres;
+    float current = 0.0;
+    for(int i=0; i&lt;nbSpheres; ++i)
+    {
+	if (shouldTerminate()) return false;
+	shared_ptr&lt;Body&gt; sphere;
+	createSphere(sphere,i);
+	rootBody-&gt;bodies-&gt;insert(sphere);
+
+	setProgress(current++/all);
+    }
+    return true;
+}
+
+void TestSimpleViscoelastic::createBox(shared_ptr&lt;Body&gt;&amp; body, Vector3r position, Vector3r extents)
+{
+	body = shared_ptr&lt;Body&gt;(new Body(body_id_t(0),1));
+	shared_ptr&lt;SimpleViscoelasticBodyParameters&gt; physics(new SimpleViscoelasticBodyParameters);
+	shared_ptr&lt;AABB&gt; aabb(new AABB);
+	shared_ptr&lt;Box&gt; gBox(new Box);
+	shared_ptr&lt;InteractingBox&gt; iBox(new InteractingBox);
+	
+	
+	Quaternionr q;
+	q.FromAxisAngle( Vector3r(0,0,1),0);
+
+	body-&gt;isDynamic			= false;
+	
+	physics-&gt;angularVelocity	= Vector3r(0,0,0);
+	physics-&gt;velocity		= Vector3r(0,0,0);
+	physics-&gt;mass			= extents[0]*extents[1]*extents[2]*density*8; 
+	physics-&gt;inertia		= Vector3r(physics-&gt;mass*(extents[1]*extents[1]+extents[2]*extents[2])/3
+						, physics-&gt;mass*(extents[0]*extents[0]+extents[2]*extents[2])/3
+						, physics-&gt;mass*(extents[1]*extents[1]+extents[0]*extents[0])/3);
+	physics-&gt;se3			= Se3r(position,q);
+	physics-&gt;setViscoelastic(physics-&gt;mass, tc, en, es);
+	physics-&gt;mu			= mu;
+
+	aabb-&gt;diffuseColor		= Vector3r(1,0,0);
+
+	gBox-&gt;extents			= extents;
+	gBox-&gt;diffuseColor		= Vector3r(1,1,1);
+	gBox-&gt;wire			= false;
+	gBox-&gt;visible			= true;
+	gBox-&gt;shadowCaster		= true;
+	
+	iBox-&gt;extents			= extents;
+	iBox-&gt;diffuseColor		= Vector3r(1,1,1);
+
+	body-&gt;boundingVolume		= aabb;
+	body-&gt;interactingGeometry	= iBox;
+	body-&gt;geometricalModel		= gBox;
+	body-&gt;physicalParameters	= physics;
+}
+
+void TestSimpleViscoelastic::createActors(shared_ptr&lt;MetaBody&gt;&amp; rootBody)
+{
+    shared_ptr&lt;PhysicalActionContainerInitializer&gt; physicalActionInitializer(new PhysicalActionContainerInitializer);
+    physicalActionInitializer-&gt;physicalActionNames.push_back(&quot;Force&quot;);
+    physicalActionInitializer-&gt;physicalActionNames.push_back(&quot;Momentum&quot;);
+    
+    shared_ptr&lt;InteractionGeometryMetaEngine&gt; interactionGeometryDispatcher(new InteractionGeometryMetaEngine);
+    interactionGeometryDispatcher-&gt;add(&quot;InteractingSphere2InteractingSphere4SpheresContactGeometry&quot;);
+    interactionGeometryDispatcher-&gt;add(&quot;InteractingBox2InteractingSphere4SpheresContactGeometry&quot;);
+
+    shared_ptr&lt;InteractionPhysicsMetaEngine&gt; interactionPhysicsDispatcher(new InteractionPhysicsMetaEngine);
+    interactionPhysicsDispatcher-&gt;add(&quot;SimpleViscoelasticRelationships&quot;);
+	    
+    shared_ptr&lt;BoundingVolumeMetaEngine&gt; boundingVolumeDispatcher	= shared_ptr&lt;BoundingVolumeMetaEngine&gt;(new BoundingVolumeMetaEngine);
+    boundingVolumeDispatcher-&gt;add(&quot;InteractingSphere2AABB&quot;);
+    boundingVolumeDispatcher-&gt;add(&quot;InteractingBox2AABB&quot;);
+    boundingVolumeDispatcher-&gt;add(&quot;MetaInteractingGeometry2AABB&quot;);
+    
+    shared_ptr&lt;GravityEngine&gt; gravityCondition(new GravityEngine);
+    gravityCondition-&gt;gravity = gravity;
+    
+    shared_ptr&lt;PhysicalActionApplier&gt; applyActionDispatcher(new PhysicalActionApplier);
+    applyActionDispatcher-&gt;add(&quot;NewtonsForceLaw&quot;);
+    applyActionDispatcher-&gt;add(&quot;NewtonsMomentumLaw&quot;);
+    
+    shared_ptr&lt;PhysicalParametersMetaEngine&gt; positionIntegrator(new PhysicalParametersMetaEngine);
+    positionIntegrator-&gt;add(&quot;LeapFrogPositionIntegrator&quot;);
+    shared_ptr&lt;PhysicalParametersMetaEngine&gt; orientationIntegrator(new PhysicalParametersMetaEngine);
+    orientationIntegrator-&gt;add(&quot;LeapFrogOrientationIntegrator&quot;);
+    
+    rootBody-&gt;engines.clear();
+    rootBody-&gt;engines.push_back(shared_ptr&lt;Engine&gt;(new PhysicalActionContainerReseter));
+    rootBody-&gt;engines.push_back(boundingVolumeDispatcher);	
+    rootBody-&gt;engines.push_back(shared_ptr&lt;Engine&gt;(new PersistentSAPCollider));
+    rootBody-&gt;engines.push_back(interactionGeometryDispatcher);
+    rootBody-&gt;engines.push_back(interactionPhysicsDispatcher);
+    rootBody-&gt;engines.push_back(shared_ptr&lt;Engine&gt;(new SimpleViscoelasticContactLaw));
+    rootBody-&gt;engines.push_back(gravityCondition);
+    rootBody-&gt;engines.push_back(applyActionDispatcher);
+    rootBody-&gt;engines.push_back(positionIntegrator);
+    if(!rotationBlocked) rootBody-&gt;engines.push_back(orientationIntegrator);
+
+    shared_ptr&lt;RigidBodyRecorder&gt; rigidBodyRecorder(new RigidBodyRecorder);
+    rigidBodyRecorder-&gt;outputBase = outputBase+string(&quot;-body&quot;);
+    rigidBodyRecorder-&gt;interval = interval;
+    rootBody-&gt;engines.push_back(rigidBodyRecorder);
+
+    shared_ptr&lt;SimpleViscoelasticSpheresInteractionRecorder&gt; interactionRecorder(new SimpleViscoelasticSpheresInteractionRecorder);
+    interactionRecorder-&gt;outputBase = outputBase+string(&quot;-interaction&quot;);
+    interactionRecorder-&gt;interval = interval;
+    rootBody-&gt;engines.push_back(interactionRecorder);
+
+    rootBody-&gt;initializers.clear();
+    rootBody-&gt;initializers.push_back(physicalActionInitializer);
+    rootBody-&gt;initializers.push_back(boundingVolumeDispatcher);
+}
+
+void TestSimpleViscoelastic::createSphere(shared_ptr&lt;Body&gt;&amp; body, int i)
+{
+	body = shared_ptr&lt;Body&gt;(new Body(body_id_t(0),1));
+	shared_ptr&lt;SimpleViscoelasticBodyParameters&gt; physics(new SimpleViscoelasticBodyParameters);
+	shared_ptr&lt;AABB&gt; aabb(new AABB);
+	shared_ptr&lt;Sphere&gt; gSphere(new Sphere);
+	shared_ptr&lt;InteractingSphere&gt; iSphere(new InteractingSphere);
+	
+	Quaternionr q;
+	q.FromAxisAngle( Vector3r(0,0,1),0);
+	
+	Vector3r position = Vector3r(0,i*(2.0*R+h)+2*groundSize[1]+h,0);
+	
+//	Real radius 			= (Mathr::IntervalRandom(minRadius,maxRadius));
+	Real radius = R;
+	
+	body-&gt;isDynamic	= true;
+	
+	physics-&gt;angularVelocity	= angular_vel;
+	physics-&gt;velocity		= velocity;
+	physics-&gt;mass			= 4.0/3.0*Mathr::PI*radius*radius*radius*density;
+	physics-&gt;inertia		= Vector3r(2.0/5.0*physics-&gt;mass*radius*radius,2.0/5.0*physics-&gt;mass*radius*radius,2.0/5.0*physics-&gt;mass*radius*radius); //
+	physics-&gt;se3			= Se3r(position,q);
+	physics-&gt;setViscoelastic(physics-&gt;mass, tc, en, es);
+//	physics-&gt;frictionAngle		= sphereFrictionDeg * Mathr::PI/180.0;
+	physics-&gt;mu			= mu;
+
+	aabb-&gt;diffuseColor		= Vector3r(0,1,0);
+
+	gSphere-&gt;radius			= radius;
+	gSphere-&gt;diffuseColor		= Vector3r(Mathr::UnitRandom(),Mathr::UnitRandom(),Mathr::UnitRandom());
+	gSphere-&gt;wire			= false;
+	gSphere-&gt;visible		= true;
+	gSphere-&gt;shadowCaster		= true;
+	
+	iSphere-&gt;radius			= radius;
+	iSphere-&gt;diffuseColor		= Vector3r(0.8,0.3,0.3);
+
+	body-&gt;interactingGeometry	= iSphere;
+	body-&gt;geometricalModel		= gSphere;
+	body-&gt;boundingVolume		= aabb;
+	body-&gt;physicalParameters	= physics;
+}
+    
+
+void TestSimpleViscoelastic::positionRootBody(shared_ptr&lt;MetaBody&gt;&amp; rootBody) 
+{
+	rootBody-&gt;isDynamic		= false;
+	
+	Quaternionr q;
+	q.FromAxisAngle( Vector3r(0,0,1),0);
+
+	shared_ptr&lt;ParticleParameters&gt; physics(new ParticleParameters); 
+	physics-&gt;se3				= Se3r(Vector3r(0,0,0),q);
+	physics-&gt;mass				= 0;
+	physics-&gt;velocity			= Vector3r(0,0,0);
+	physics-&gt;acceleration			= Vector3r::ZERO;
+		
+	shared_ptr&lt;MetaInteractingGeometry&gt; set(new MetaInteractingGeometry());
+	set-&gt;diffuseColor			= Vector3r(0,0,1);
+	
+	shared_ptr&lt;AABB&gt; aabb(new AABB);
+	aabb-&gt;diffuseColor			= Vector3r(0,0,1);
+	
+	rootBody-&gt;interactingGeometry		= YADE_PTR_CAST&lt;InteractingGeometry&gt;(set);	
+	rootBody-&gt;boundingVolume		= YADE_PTR_CAST&lt;BoundingVolume&gt;(aabb);
+	rootBody-&gt;physicalParameters 		= physics;
+}
+
+    
+    

Added: trunk/pkg/dem/PreProcessor/TestSimpleViscoelastic.hpp
===================================================================
--- trunk/pkg/dem/PreProcessor/TestSimpleViscoelastic.hpp	2008-03-25 09:54:02 UTC (rev 1284)
+++ trunk/pkg/dem/PreProcessor/TestSimpleViscoelastic.hpp	2008-03-25 19:13:54 UTC (rev 1285)
@@ -0,0 +1,70 @@
+/*************************************************************************
+*  Copyright (C) 2006 by Sergei Dorofeenko				 *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">sega at users.berlios.de</A>                                                 *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#ifndef TESTSIMPLEVISCOELASTIC_HPP 
+#define TESTSIMPLEVISCOELASTIC_HPP
+
+#include &lt;yade/core/FileGenerator.hpp&gt;
+
+class TestSimpleViscoelastic : public FileGenerator {
+    private:
+	
+	/// Collision time
+	Real tc; 
+	/// Normal restitution coefficient
+	Real en;
+	/// Shear restitution coefficient
+       	Real es;
+	/// Coulomb friction
+	Real mu;
+	/// Spheres radius
+	Real R;
+	/// Materials density
+	Real density;
+	/// Number of spheres
+	Real nbSpheres;
+	/// Height between spheres
+	Real h;
+	/// Initial velocity of spheres
+	Vector3r velocity; 
+	/// Initial angular velocity of spheres
+	Vector3r angular_vel; 
+	/// Gravity
+	Vector3r gravity;
+	/// Size of bottom box
+	Vector3r groundSize;
+	/// Base name of results file
+	std::string outputBase;
+	/// Saves interval
+	int interval;
+	
+	bool rotationBlocked;
+
+	void createActors(shared_ptr&lt;MetaBody&gt;&amp; rootBody);
+	void createSphere(shared_ptr&lt;Body&gt;&amp; body, int i);
+	void createBox(shared_ptr&lt;Body&gt;&amp; body, Vector3r position, Vector3r extents);
+	void positionRootBody(shared_ptr&lt;MetaBody&gt;&amp; rootBody);
+
+    public:
+	TestSimpleViscoelastic();
+	~TestSimpleViscoelastic();
+
+    protected:
+	bool generate();
+
+	virtual void postProcessAttributes(bool deserializing);
+	void registerAttributes();
+
+	REGISTER_CLASS_NAME(TestSimpleViscoelastic);
+	REGISTER_BASE_CLASS_NAME(FileGenerator);
+};
+
+REGISTER_SERIALIZABLE(TestSimpleViscoelastic,false);
+
+#endif // TESTSIMPLEVISCOELASTIC_HPP
+

Added: trunk/pkg/dem/RenderingEngine/GLDrawSimpleViscoelasticInteraction/GLDrawSimpleViscoelasticInteraction.cpp
===================================================================
--- trunk/pkg/dem/RenderingEngine/GLDrawSimpleViscoelasticInteraction/GLDrawSimpleViscoelasticInteraction.cpp	2008-03-25 09:54:02 UTC (rev 1284)
+++ trunk/pkg/dem/RenderingEngine/GLDrawSimpleViscoelasticInteraction/GLDrawSimpleViscoelasticInteraction.cpp	2008-03-25 19:13:54 UTC (rev 1285)
@@ -0,0 +1,38 @@
+/*************************************************************************
+*  Copyright (C) 2006 by Sergei Dorofeenko				 *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">sega at users.berlios.de</A>                                                 *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#include &quot;GLDrawSimpleViscoelasticInteraction.hpp&quot;
+#include &lt;yade/pkg-dem/SimpleViscoelasticInteraction.hpp&gt;
+#include&lt;yade/lib-opengl/OpenGLWrapper.hpp&gt;
+
+
+void GLDrawSimpleViscoelasticInteraction::go(
+		const shared_ptr&lt;InteractionPhysics&gt;&amp; ip,
+		const shared_ptr&lt;Interaction&gt;&amp;,
+		const shared_ptr&lt;Body&gt;&amp; b1,
+		const shared_ptr&lt;Body&gt;&amp; b2,
+		bool wireFrame)
+{
+	SimpleViscoelasticInteraction* p = static_cast&lt;SimpleViscoelasticInteraction*&gt;(ip.get());
+	Vector3r mid = 0.5*(b1-&gt;physicalParameters-&gt;se3.position+b2-&gt;physicalParameters-&gt;se3.position);
+	glTranslatev(mid);
+	glColor3(1.0,0.0,0.0);
+	
+	glPushMatrix();
+	glRasterPos2i(0,0);
+	std::string str;
+	str = std::string(&quot;  kn=&quot;) + boost::lexical_cast&lt;std::string&gt;((float)(p-&gt;kn))
+	    + std::string(&quot;  cn=&quot;) + boost::lexical_cast&lt;std::string&gt;((float)(p-&gt;cn))
+	    + std::string(&quot;  ks=&quot;) + boost::lexical_cast&lt;std::string&gt;((float)(p-&gt;ks))
+	    + std::string(&quot;  cs=&quot;) + boost::lexical_cast&lt;std::string&gt;((float)(p-&gt;cs));
+	for(unsigned int i=0;i&lt;str.length();i++)
+		glutBitmapCharacter(GLUT_BITMAP_HELVETICA_12, str[i]);
+	glPopMatrix();
+}
+
+YADE_PLUGIN();

Added: trunk/pkg/dem/RenderingEngine/GLDrawSimpleViscoelasticInteraction/GLDrawSimpleViscoelasticInteraction.hpp
===================================================================
--- trunk/pkg/dem/RenderingEngine/GLDrawSimpleViscoelasticInteraction/GLDrawSimpleViscoelasticInteraction.hpp	2008-03-25 09:54:02 UTC (rev 1284)
+++ trunk/pkg/dem/RenderingEngine/GLDrawSimpleViscoelasticInteraction/GLDrawSimpleViscoelasticInteraction.hpp	2008-03-25 19:13:54 UTC (rev 1285)
@@ -0,0 +1,27 @@
+/*************************************************************************
+*  Copyright (C) 2006 by Sergei Dorofeenko				 *
+*  <A HREF="https://lists.berlios.de/mailman/listinfo/yade-dev">sega at users.berlios.de</A>                                                 *
+*                                                                        *
+*  This program is free software; it is licensed under the terms of the  *
+*  GNU General Public License v2 or later. See file LICENSE for details. *
+*************************************************************************/
+
+#ifndef GLDRAW_SIMPLEVISCOELASTIC_INTERACTION_HPP
+#define GLDRAW_SIMPLEVISCOELASTIC_INTERACTION_HPP
+
+#include &lt;yade/pkg-common/GLDrawInteractionPhysicsFunctor.hpp&gt;
+
+class GLDrawSimpleViscoelasticInteraction : public GLDrawInteractionPhysicsFunctor
+{
+	public :
+		virtual void go(const shared_ptr&lt;InteractionPhysics&gt;&amp;,const shared_ptr&lt;Interaction&gt;&amp;,const shared_ptr&lt;Body&gt;&amp;,const shared_ptr&lt;Body&gt;&amp;,bool wireFrame);
+
+	RENDERS(SimpleViscoelasticInteraction);
+	REGISTER_CLASS_NAME(GLDrawSimpleViscoelasticInteraction);
+	REGISTER_BASE_CLASS_NAME(GLDrawInteractionPhysicsFunctor);
+};
+
+REGISTER_SERIALIZABLE(GLDrawSimpleViscoelasticInteraction,false);
+
+#endif //GLDRAW_SIMPLEVISCOELASTIC_INTERACTION_HPP
+

Modified: trunk/pkg/dem/SConscript
===================================================================
--- trunk/pkg/dem/SConscript	2008-03-25 09:54:02 UTC (rev 1284)
+++ trunk/pkg/dem/SConscript	2008-03-25 19:13:54 UTC (rev 1285)
@@ -1,3 +1,4 @@
+# vim: set filetype=python :
 Import('*')
 env.Install('$PREFIX/lib/yade$SUFFIX/pkg-dem',[
 
@@ -869,9 +870,73 @@
 			'RigidBodyParameters'
 			 ]),
 
+	env.SharedLibrary('SimpleViscoelasticBodyParameters'
+		,['DataClass/PhysicalParameters/SimpleViscoelasticBodyParameters.cpp']
+		,LIBS=env['LIBS']+['RigidBodyParameters'])
 
+	,env.SharedLibrary('SimpleViscoelasticInteraction'
+		,['DataClass/InteractionPhysics/SimpleViscoelasticInteraction.cpp'])
+    
+	,env.SharedLibrary('GLDrawSimpleViscoelasticInteraction'
+	    ,['RenderingEngine/GLDrawSimpleViscoelasticInteraction/GLDrawSimpleViscoelasticInteraction.cpp']
+	    ,LIBS=env['LIBS']+['yade-opengl','SimpleViscoelasticInteraction'])
 
+	,env.SharedLibrary('SimpleViscoelasticRelationships'
+		,['Engine/EngineUnit/SimpleViscoelasticRelationships.cpp']
+		,LIBS=env['LIBS']+['SimpleViscoelasticBodyParameters'
+		    ,'SimpleViscoelasticInteraction'
+		    ,'SpheresContactGeometry'
+		    ])
 
+	,env.SharedLibrary('SimpleViscoelasticContactLaw'
+		,['Engine/StandAloneEngine/SimpleViscoelasticContactLaw.cpp']
+		,LIBS=env['LIBS']+['SimpleViscoelasticInteraction'
+		    ,'SimpleViscoelasticBodyParameters'
+		    ,'SpheresContactGeometry'
+		    ,'Force'
+		    ,'Momentum'
+		    ])
+	
+	,env.SharedLibrary('SimpleViscoelasticSpheresInteractionRecorder'
+	    ,['Engine/StandAloneEngine/SimpleViscoelasticSpheresInteractionRecorder.cpp']
+	    ,LIBS=env['LIBS']+['SpheresContactGeometry','SimpleViscoelasticInteraction'])
 
+	,env.SharedLibrary('RigidBodyRecorder'
+	,['Engine/StandAloneEngine/RigidBodyRecorder.cpp']
+	,LIBS=env['LIBS']+['RigidBodyParameters'])
+
+	,env.SharedLibrary('TestSimpleViscoelastic'
+		,['PreProcessor/TestSimpleViscoelastic.cpp']
+		,LIBS=env['LIBS']+['AABB'
+			    ,'Box'
+			    ,'InteractingBox'
+			    ,'SimpleViscoelasticRelationships'
+			    ,'SimpleViscoelasticContactLaw'
+			    ,'SimpleViscoelasticBodyParameters'
+			    ,'SimpleViscoelasticInteraction'
+			    ,'SimpleViscoelasticSpheresInteractionRecorder'
+			    ,'GravityEngine'
+			    ,'BodyRedirectionVector'
+			    ,'BoundingVolumeMetaEngine'
+			    ,'InteractingSphere'
+			    ,'InteractionGeometryMetaEngine'
+			    ,'InteractionPhysicsMetaEngine'
+			    ,'InteractionVecSet'
+			    ,'MetaInteractingGeometry'
+			    ,'MetaInteractingGeometry2AABB'
+			    ,'ParticleParameters'
+			    ,'RigidBodyRecorder'
+			    ,'PhysicalActionApplier'
+			    ,'PhysicalActionContainerInitializer'
+			    ,'PhysicalActionContainerReseter'
+			    ,'PhysicalActionVectorVector'
+			    ,'PhysicalParametersMetaEngine'
+			    ,'PersistentSAPCollider'
+			    ,'Sphere'
+			    ])
+
+
+
+
 ])
 



-------------------------------------------------------


-------------------------------------------------------

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000135.html">[yade-dev] svn-1284 compile error
</A></li>
	<LI>Next message: <A HREF="000136.html">[yade-dev] using cerr in TriaxialTest
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#133">[ date ]</a>
              <a href="thread.html#133">[ thread ]</a>
              <a href="subject.html#133">[ subject ]</a>
              <a href="author.html#133">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/yade-dev">More information about the yade-dev
mailing list</a><br>
</body></html>
